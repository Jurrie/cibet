<?xml version="1.0" encoding="UTF-8"?>
<cibet xmlns="http://www.logitags.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.logitags.com http://www.logitags.com/cibet/cibet-config_1.2.xsd">

	<actuator name="schedEE">
		<class>com.logitags.cibet.actuator.scheduler.SchedulerActuator</class>
		<properties>
			<timerStart>2040.12.01 12:00:00</timerStart>
			<timerPeriod>4000</timerPeriod>
			<persistenceUnit>APPL-UNIT</persistenceUnit>
		</properties>
	</actuator>

	<actuator name="SEC">
		<class>com.logitags.cibet.actuator.shiro.ShiroActuator</class>
		<properties>
			<isPermittedAll>denyAll:*</isPermittedAll>
			<throwDeniedException>true</throwDeniedException>
		</properties>
	</actuator>

	<actuator name="SEC2">
		<class>com.logitags.cibet.actuator.shiro.ShiroActuator</class>
		<properties>
			<hasAllRoles>MANAGER</hasAllRoles>
			<throwDeniedException>false</throwDeniedException>
		</properties>
	</actuator>

	<actuator name="SEC3">
		<class>com.logitags.cibet.actuator.shiro.ShiroActuator</class>
		<properties>
			<requiresAuthentication>true</requiresAuthentication>
		</properties>
	</actuator>

	<actuator name="SEC-URLpermit">
		<class>com.logitags.cibet.actuator.shiro.ShiroActuator</class>
		<properties>
			<requiresGuest>false</requiresGuest>
		</properties>
	</actuator>
	
	<actuator name="SEC-URLdeny">
		<class>com.logitags.cibet.actuator.shiro.ShiroActuator</class>
		<properties>
			<requiresUser>true</requiresUser>
			<throwDeniedException>true</throwDeniedException>
		</properties>
	</actuator>

	<setpoint id="SD23">
		<controls>
			<event>INVOKE</event>
			<target>com.cibethelper.ejb.OutService</target>
			<method>logThis</method>
			<condition>! $PARAM0.equals('gutte')</condition>
		</controls>
		<actuator name="SEC2"/>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="SD24">
		<controls>
			<event>PERSIST</event>
			<target>com.cibethelper.entities.TEntity</target>
			<condition>$SESSIONSCOPE.getProperty('Freds')!=null &amp;&amp; $SESSIONSCOPE.getProperty('Freds').getCounter()==8</condition>
		</controls>
		<actuator name="SEC3"/>
		<actuator name="FOUR_EYES"/>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="SD25">
		<controls>
			<event>PERSIST</event>
         <target>com.cibethelper.entities.TEntity</target>
			<condition>$SESSIONSCOPE.getProperty('Freds')==null</condition>
			<invoker exclude="true">com.logitags.cibet.actuator.scheduler.SESchedulerTask</invoker>
		</controls>
		<actuator name="SEC"/>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="SD26">
		<controls>
			<event>RELEASE</event>
         <target>com.cibethelper.entities.TEntity</target>
		</controls>
		<actuator name="SEC2"/>
		<actuator name="FOUR_EYES"/>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="SD27-deny">
		<controls>
			<event>INVOKE</event>
			<target>http://localhost:8788/TomcatTestJdbc/logThis.url, http://localhost:8788/TomcatTestJpa/logThis.url</target>
			<tenant>XYCompany</tenant>
		</controls>
		<actuator name="SEC-URLdeny"/>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="SD23-allow" extends="SD23">
		<controls>
			<condition>$PARAM0.equals('gutte')</condition>
		</controls>
		<actuator name="TRACKER"/>
	</setpoint>

	<setpoint id="SD28-permit" extends="SD27-deny">
		<controls>
			<condition>"red".equals($HTTPPARAMETERS.get('color'))</condition>
			<tenant></tenant>
		</controls>
		<actuator name="SEC-URLpermit"/>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="SD29-4eyes" extends="SD28-permit">
		<controls>
			<condition>"blue".equals($HTTPPARAMETERS.get('color'))</condition>
		</controls>
		<actuator name="TWO_MAN_RULE"/>
		<actuator name="ARCHIVE"/>
	</setpoint>
	
	<setpoint id="jdbc1">
		<controls>
			<target>cib_testentity</target>
			<event>INSERT</event>	
		</controls>
		<actuator name="ARCHIVE"/>
	</setpoint>

	<setpoint id="sched1">
		<controls>
			<target>com.cibethelper.entities.TEntity, org.apache.openjpa.enhance.*</target>
			<event>UPDATE</event>
		</controls>
		<actuator name="schedEE"/>
	</setpoint>

	<setpoint id="merge1">
		<controls>
			<target>com.logitags.cibet.helper.TComplexEntity2</target>
			<event>INSERT</event>
			<condition>$TARGET.getCompValue()==12</condition>
		</controls>
		<actuator name="ARCHIVE"/>
	</setpoint>
	<setpoint id="merge2">
		<controls>
			<target>com.logitags.cibet.helper.TComplexEntity2</target>
			<event>UPDATE</event>
			<!-- stateChange>compValue</stateChange-->
		</controls>
		<actuator name="ARCHIVE"/>
	</setpoint>

</cibet>   